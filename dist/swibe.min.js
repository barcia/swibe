!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Swibe=t()}(this,function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}return function(t){var i,n=e({menu:"swibe-menu",trigger:"swibe-menu-trigger",breakpoint:void 0,width:300,time:300,shadowOpacity:.5,aria:!0,initialState:!1,selfClose:!1,zIndex:999},t);document.addEventListener("DOMContentLoaded",function(){s.load()&&s.init()});var s={load:function(){return!(!o.get()||!l.get())||(console.warn("Swibe items not loaded"),!1)},init:function(){return o.init(),l.init(),r.init(),n.breakpoint?(d.checkMediaQuery(d.mediaQuery),d.mediaQuery.addListener(d.checkMediaQuery)):this.addListeners(),0==n.initialState?s.close():s.open(),!0},addListeners:function(){return l.element.addEventListener("click",s.toggle,!1),document.addEventListener("touchstart",a.tap,!1),document.addEventListener("touchmove",a.slide,!1),document.addEventListener("keydown",a.keypress,!1),n.selfClose&&o.element.addEventListener("click",s.close,!1),!0},removeListeners:function(){return l.element.removeEventListener("click",s.toggle,!1),document.removeEventListener("touchstart",a.tap,!1),document.removeEventListener("touchmove",a.slide,!1),document.removeEventListener("keydown",a.keypress,!1),n.selfClose&&o.element.removeEventListener("click",s.close,!1),!0},open:function(){return o.open(),l.open(),r.open(),document.body.style.overflow="hidden",i=!0,!0},close:function(){return o.close(),l.close(),r.close(),document.body.style.overflow=null,i=!1,!0},toggle:function(){return this.state?s.close():s.open(),!0}},o={get:function(){return this.element=document.getElementById(n.menu),!!this.element},init:function(){return this.element.style.position="fixed",this.element.style.top=0,this.element.style.left=-n.width+"px",this.element.style.width=n.width+"px",this.element.style.maxWidth="calc(100vw - 40px)",this.element.style.height="100vh",this.element.style.transition="left ease-in-out",this.element.style.transitionDuration=n.time+"ms",this.element.style.willChange="left",this.element.style.overflowY="auto",this.element.style.zIndex=n.zIndex,n.aria&&this.element.setAttribute("aria-labelledby",n.trigger),!0},open:function(){return this.element.style.left=0,this.element.setAttribute("data-state",!0),n.aria&&this.element.setAttribute("aria-hidden",!1),!0},close:function(){return this.element.style.left=-n.width+"px",this.element.setAttribute("data-state",!1),n.aria&&this.element.setAttribute("aria-hidden",!0),!0}},l={get:function(){return this.element=document.getElementById(n.trigger),!!this.element},init:function(){return n.aria&&this.element.setAttribute("aria-controls",n.menu),n.aria&&this.element.setAttribute("aria-haspopup",!0),!0},open:function(){return this.element.setAttribute("data-state",!0),n.aria&&this.element.setAttribute("aria-expanded",!0),!0},close:function(){return this.element.setAttribute("data-state",!1),n.aria&&this.element.setAttribute("aria-expanded",!1),!0}},r={init:function(){return this.element=document.createElement("div"),this.element.id=n.menu+"-shadow",this.element.style.position="fixed",this.element.style.backgroundColor="hsl(0, 0%, 0%)",this.element.style.top=0,this.element.style.left=0,this.element.style.zIndex=n.zIndex-1,this.element.addEventListener("click",s.close),n.aria&&this.element.setAttribute("aria-hidden",!0),document.body.appendChild(this.element),!0},open:function(){return this.element.style.width="100vw",this.element.style.height="100vh",this.element.style.opacity=n.shadowOpacity,this.element.style.transition="opacity ease-in-out, height step-start, width step-start",this.element.style.transitionDuration=n.time+"ms",this.element.setAttribute("data-state",!0),!0},close:function(){return this.element.style.width=0,this.element.style.height=0,this.element.style.opacity=0,this.element.style.transition="opacity ease-in-out, height step-end, width step-end",this.element.style.transitionDuration=n.time+"ms",this.element.setAttribute("data-state",!1),!0}},a={tap:function(e){var t=e.touches[0];return this.tapX=t.clientX,this.tapY=t.clientY,this.slideX=this.tapX,this.slideY=this.tapY,!0},slide:function(e){var t=e.touches[0];return this.slideX=t.clientX,this.slideY=t.clientY,i?!!a.gre.close(this.tapX,this.tapY,this.slideX,this.slideY)&&(s.close(),!0):!!a.gre.open(this.tapX,this.tapY,this.slideX,this.slideY)&&(s.open(),!0)},keypress:function(e){"Escape"===e.key&&i&&s.close()},gre:{open:function(e,t,i,n){return this.openCond1=e<20,this.openCond2=i>e,!(!this.openCond1||!this.openCond2)},close:function(e,t,i,n){return this.distX=i-e,this.distY=n-t,this.angle=180*Math.atan(this.distY/this.distX)/Math.PI+90,this.closeCond1=i<e,this.closeCond2=this.distY<280,this.closeCond3=this.distX<-30,this.closeCond4=this.angle>55,this.closeCond5=this.angle<125,!!(this.closeCond1&&this.closeCond2&&this.closeCond3&&this.closeCond4&&this.closeCond5)}}},d={mediaQuery:window.matchMedia("(max-width: "+n.breakpoint+"px)"),checkMediaQuery:function(e){return e.matches?s.addListeners():(s.close(),s.removeListeners()),!0}}}});
